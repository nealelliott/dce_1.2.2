#
# ID: $Id: restoredb-2.1.1e,v 1.3 1996/01/21 09:47:20 hyer Exp $
#
# COMPONENT_NAME: bak
#
# The following functions list may not be complete.
# Functions defined by/via macros may not be included.
#
# FUNCTIONS:
#
#
# ORIGINS: Transarc Corp.
#
# (C) COPYRIGHT Transarc Corp. 1994
# All Rights Reserved
# Licensed Materials - Property of Transarc
#
# US Government Users Restricted Rights - Use, duplication or
# disclosure restricted by GSA ADP Schedule Contract with Transarc Corp
#
# HISTORY
# $TALog: restoredb-2.1.1e,v $
# Revision 1.3  1996/01/21  09:47:20  hyer
# Changes to make the backup test scripts with the callout routines for
# mount and unmount in DCE 1.2.
#
# Added cm checkfilesets and cleaned up test to run with callout routines
# [from r1.2 by delta hyer-7265-backup-test-mods-for-callout-routines, r1.1]
#
# Revision 1.2  1994/01/07  18:02:25  davecarr
# Upgraded tests to work with expect-5.1.3.  Also moved some configuration
# dependencies from restoredb-cmd to generic.exp.  In the process, some
# variables had "dbr_" prepended to them to indicate that they are used only
# for the restoredb tests.
#
# Upgraded test to work with expect-5.1.3.
# [from r1.1 by delta davecarr-db4736-bak-restoredb-tests, r1.2]
#
# Revision 1.1  1993/11/24  18:44:43  davecarr
#    This the first pass at automating tests for the bak restoredb command.  They
# work with expect-4.3.  They will need to be updated to work with expect,
# version 5.
#
# Initial checkin.  Test works with expect-4.3.
# [added by delta davecarr-db4736-bak-restoredb-tests, r1.1]
#
#

# defined in generic.exp or restoredb-cmd:
#     bak_id, prompt
#

TEST-SETUP

    CATCHEXEC "cm checkfilesets"


TEST-PRE
    if ![verifydb_p $bak_id] {
        send_user "Test preconditions failed.\n"
        unset run
    }
    # Should also check that 666 is not in db.

TEST-EXEC
    send -i $bak_id "restoredb 666\r"

TEST-POST

TEST-EVAL
    expect {
        -i $bak_id $prompt {
	    if ![string match\
	         "*Unable to connect to tape coordinator at port 666*"\
		 $expect_out(buffer)] {
	        unset pass
            }
	}
	-i $bak_id timeout {
	    unset pass
	}
    }

TEST-CLEANUP
