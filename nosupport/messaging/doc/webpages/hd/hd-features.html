<HTML>
<HEAD>
<TITLE>High Level Design - Infrastructure -- Features</TITLE>
</HEAD>
<!-- $Header: -->
<BODY>
<H1 ALIGN=CENTER>High Level Design - Infrastructure -- Features</H1>

<P ALIGN=CENTER>
August 21, 1996
</P>

We support the following messaging features. We describe them one by one, 
with the definition first. When going through each of the features, please
keep the model in mind.
<P>

<H2>Messaging Mode</H2>

We support asynchronous and synchronous messaging, with different wait
options. Depending on the messaging model (message queuing
verse message passing), the combination of the two has different meaning.
<P>
In synchronous messaging, the execution of the sender is blocked until
the message has been retrieved by a recipient. This only applies to the
messsage passing model.
<P>

For retrieving messages, both the message passing model and the message
queuing model works similarly. On the receive API, there is a 
wait option which a caller may specify whether to wait
for a message that meets the selection criteria to become available.
<P>

The following table describes the meaning of possible combinations for
message sending:
<P>

<H3>Message Passing Model</H3>

<DL>
<DT>Asynchronous<DD>
Send a message and have control return immediately
to the application. The message delivery status
is completely unknown when returning from the send
operation. However, the sender can find out 
message delivery status through receipt of ACK
messages requested via various notice options.
<P>
<DT>Synchronous, blocking<DD>
Send a message and have control return to the
application after the message has been retrieved
from the recipient.
</DL>
<H3>Messaging Queuing Model</H3>

<DL>
<DT>Asynchronous, No wait<DD>
Send a message and have control return immediately
to the application. The message delivery status
is completely unknown when returning from the send
operation. However, the sender can find out 
message delivery status through receipt of ACK
messages requested via various notice options.
<P>
<DT>Asynchronous, Wait for enqueue<DD>
Send a message and have control return to the 
application after the messaging system takes control
of the message. At this point, the message has been
enqueued, but the "dequeue" delivery status is 
unknown. However, the sender can find out 
message delivery status through receipt of ACK
messages requested via various notice options.
<P>
<DT>Asynchronous, Wait for dequeue<DD>
Send a message and have control return to the
application after the message has been dequeued
from the messaging system.
</DL>


<H2>Data marshalling</H2>

We support typed messages. A message can have arbitrarily complex data
structure, not just a stream of bytes. We use DCE's IDL encoding service to
achieve the data marshalling and unmarshalling.
<P>

Specifically, the user defines a data structure for a message in the
interface definition file, with a unique identification called data type
identification. The user also supplies a function name (with a
well known function prototype) as the conversion routine for this data
type. The code for this conversion function is generated by the IDL
compiler.
<P>

Before sending or receiving a message, the user calls a supplied API to
register a conversion function with a specific data type identification
into the messaging runtime. The user can register more than one type. This
is especially important for a recipient who wants to receive multiple types
of messages from the same queue.
<P>

Once the registration is done, the runtime knows how to encode a typed
message for sending. The runtime also knows how to decode an incoming
message with encoded data.
<P>

<H2>Group Communication</H2>

A group send operation sends a message to multiple destinations.
These destinations can exist on different queue managers, running on
different hosts. Some products call this feature "broadcasting".
<P>

We support this feature by employing DCE NSI group naming approach to
configure multiple destinations under one group name.
<P>

<H2>Quality of services</H2>

Messaging applications can specify aspects of the quality of service that
will be employed when making certain operations. The term 
<I>quality of service</I> 
is used to characterize the reliability and timeless of message
delivery.
<P>

<H3>End-to-end Protection Level</H3>

We support end-to-end protection. A sender can specify an end-to-end
protection level he wants for a message. The possible levels are:
<UL>
  <LI>None. No protection.
  <LI>Authentication. Proper authentication is done to guarantee that the
       sender's identity is identified to the receiver.
  <LI>Authentication with integrity. Apart from the guaranteed authentication,
       the message is guaranteed for its integrity.
  <LI>Authentication with privacy. Apart from authentication and integrity,
       the message is further guaranteed for its confidentiality.
</UL>

A receiver, upon retrieving a message, also specifies a protection level. If
the level specified by the receiver is lower than the one specified by the
sender, the receive API will automatically negotiate the right level and use
it to retrieve the message. If the protection level specified by the receiver
is higher than the one specified by the sender, an error will be returned.


<H3>Priority</H3>

The sender can specify a priority numerical value which is interpreted as
the message urgency. The lower the value is, the more important the message
is. 
<P>

<H3>Acknowledgment</H3>

We support message acknowledgments. A messaging application can request an
acknowledgment for a message that it sends out. The sending
application should specify a queue (reply-to queue) where the
acknowledgment can be sent back to. The application can later go to this
reply-to queue to receive acknowledgments. 
<P>
The following is the type of acknowledgments that a sender can request:
<P>
<DL>
<DT>Null<DD>No acknowledgment. Default.
<P>
<DT>On Message Expiration<DD>An acknowledgment is sent when the message
expires. 
<P>
<DT>On Message Enqueued<DD>An acknowledgment is sent when the message is
enqueued. 
<P>
<DT>On Message Retrieved<DD>acknowledgment is sent when the message is
actually received by a recipient.
<P>
<DT>On Error<DD>An acknowledgment is sent when an error or an exception
happens during any operation on this message before it is retrieved.
</DL>

<H3>Persistent and volatile messages</H3>

For a persistent message, the message should be saved to the persistent storage
for the queue when the message is enqueued. This way, if the queue manager
host crashes, the message can be restored. 
<P>

Note, we don't guarantee any atomic file operation, which
means that file saving may fail in the case of disk crash or machine panic.
<P>

For a volatile message, a message is only required to be kept in the queue
manager's virtual memory. If the queue manager crashes, this message is
lost.
<P>

<H3>Expiration</H3>

A message can have an expiration time. This specifies the amount of time
that a message can remain outstanding in the queuing system.
<P>

When a message expires (i.e., its expiration time arrives), the queue manager
discards it from the queue. For a synchronous sending operation, it also
causes the operation to abort. If an "On Message Expiration" acknowledgment
is requested for the message, the queue manager is responsible to send an
expiration acknowledgment back to the sender. 
<P>
There is a default expiration value for each message. Unless otherwise set,
default expiration is 24 hours.
<P>

This feature is also called "time-to-live".
<P>

<H3>Time to receive messages</H3>

A message can have a "time to receive (TTR)" time specified. This time
instructs the queue manager to enqueue the message to the proper queue,
but only to make it available for retrieving when this time has arrived.
<P>
Before this time arrives, the message should be unavailable to any potential
recipients. Through an administration interface, all TTR messages on a
queue can be viewed.
<P>

<H3>Selection criteria for receiving</H3>

Apart from always receiving from the top of the queue, we support message
receiving based on certain selection criteria. A mask can be specified to
indicate which criteria are in effect.
<P>
<UL>
<LI>Message identification
<LI>Message type
<LI>Message priority
<LI>Message data type
<LI>Sender
</UL>

<H2>Message Sender Security Identity</H2>

We make it possible for a recipients to make authorization
decision by having the queue manager to save the sender's principal and
group information and return it along with other message attributes to the
recipient. 

<H2>Other Message Attributes</H2>

Before a message can be sent, the sender must specify certain message
attributes, in addition to the features that are described above.
<P>
Below is a list of attributes to be set before the send operation:
<UL>
  <LI>Message type. One of the following:
  <UL>
    <LI>Data. Default
    <LI>Notice (acknowledgment)
  </UL>
    <LI>Message data type
    <LI>Message's reply-to queue if acknowledgment is requested
</UL>

The following is a list of attributes that the send operation returns:
<UL>
  <LI>Message identification (generated by the API on the client side)
  <LI>Message sent time stamp (generate by the queue manager. For
multicasting send, this is the last message's sent time stamp)
</UL>

<P> <!--EndPage-->
<HR> <!-- __________________________________________________ -->
<P ALIGN=CENTER>
[
<A HREF="index.html">High-level Design TOC</A> |
<A HREF="../index.html">Messaging</A>
]
</P>
</BODY>
</HTML>
